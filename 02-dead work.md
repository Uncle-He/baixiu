# ๅๅคๅทฅไฝ

* ๆฐๆฎๅบ่ฎพ่ฎก
* ๅบ็ก็ปๆๆญๅปบ

### ๆฐๆฎๅบ่ฎพ่ฎก
> ๆนๆฎๆไปฌ็ไธๅก้่ฆ่ฎพ่ฎกๆฐๆฎๅบ็็ปๆ๏ผ่ฟไธช่ฟ็จๆฏๆฏไธช้กน็ฎๅผๅงๆถๆๅฟ้กป็๏ผไธ่ฌ็ฑไธ้จ็ DBA ่ง่ฒๅฎๆ๏ผๅพๅคๆฒกๆๅๅ็้ๅธธๅทไฝ็ๅฌๅธ็ฑๅ็ซฏๅผๅไบบๅๅผไปป๏ผใ

![ๆฐๆฎๅบ็ปๆ](https://github.com/Uncle-He/baixiu/blob/master/media/database.png)

### ้้กน่กจ๏ผoptions๏ผ
็จไบ่ฎฐๅฝ็ฝ็ซ็ไธไบ้็ฝฎๅฑๆงไฟกๆฏ๏ผๅฆ๏ผ็ซ็นๆ้ข๏ผ็ซ็นๆ่ฟฐ็ญ

| ๅญๆฎต | ๆ่ฟฐ | ๅคๆณจ |
| --- | --- | --- |
| id | ๐ไธป้ฎ |  |
| key | ๅฑๆงๅผ | snake_case |
| value | ๅฑๆงๅผ | JSONๆผๅผ |

### ็จๆท่กจ
็จไบ่ฎฐๅฝ็จๆทไฟกๆฏ

| ๅญๆฎต | ๆ่ฟฐ | ๅคๆณจ |
| --- | --- | --- |
| id | ๐ไธป้ฎ |  |
| slug | URLๅซๅ |  |
| email | ้ฎ็ฎฑ | ไบฆๅ็ปๅฝๅ |
| password | ๅฏ็ |  |
| nickname | ๆต็งฐ |  |
| avatar | ๅคดๅ | ๅคดๅURL่ทฏๅพ |
| bio | ็ฎไป |  |
| status | ็ถๆ | ๆชๆฟๆดป(unactivated)/ๆฟๆดป(activated)/็ฆๆญข(forbidden)/ๅๆถ็ซ(trashed) |

### ๆ็ซ่กจ๏ผposts๏ผ
็จไบ่ฎฐๅฝๆ็ซไฟกๆฏ


| ๅญๆฎต | ๆ่ฟฐ | ๅคๆณจ |
| --- | --- | --- |
| id | ๐ไธป้ฎ |  |
| slug | URLๅซๅ |  |
| title | ๆ้ข |  |
| feature | ็น่ฒๅพๅ | ๅพ็URL่ทฏๅพ |
| created | ๅๅปบๆถ้ด |  |
| content | ๅๅฎน |  |
| views | ๆต่งๆฌกๆฐ |  |
| likes | ็น่ตๆฐ |  |
| status | ็ถๆ | ่็จฟ(drafted)/ๅทฒๅๅธ(published)/ๅๆถ็ซ(trashed) |
| user_id | ๐็จๆทID | ๅฝๅๆ็ซ็ไฝ่ID |
| category_id | ๐ๅ็ฑปID | ๅฝๅๆ็ซ็ๅ็ฑปID |

### ๅ็ฑป่กจ๏ผcategories๏ผ
็จไบ่ฎฐๅฝๆ็ซๅ็ฑปไฟกๆฏ

| ๅญๆฎต | ๆ่ฟฐ | ๅคๆณจ |
| --- | --- | --- |
| id | ๐ไธป้ฎ |  |
| slug | URLๅซๅ |  |
| name | ๅ็ฑปๅ็งฐ |  |

### ่ฏ่ฎบ่กจ๏ผcomments๏ผ
็จไบ่ฎฐๅฝๆ็ซ่ฏ่ฎบไฟกๆฏ

| ๅญๆฎต | ๆ่ฟฐ | ๅคๆณจ |
| --- | --- | --- |
| id | ๐ไธป้ฎ |  |
| author | ไฝ่ |  |
| email | ้ฎ็ฎฑ |  |
| created | ๅๅปบๆถ้ด |  |
| content | ๅๅฎน |  |
| status | ็ถๆ | ๅพๅฎกๆธ(held)/ๅ่ฎธ(approved)/ๆ็ป(rejected)/ๅๆถ็ซ(trashed) |
| post_id | ๐ๆ็ซID |  |
| parent_id | ๐็ถ็บงID |  |

[ๅๅงๅๆฐๆฎๅบ่ๆฌ](https://github.com/Uncle-He/baixiu/blob/master/media/baixiu.sql)

### ๆญๅปบ้กน็ฎ็ปๆ
้กน็ฎๆๅบๆฌ็ๅไธบไธคไธชๅคงๅ๏ผๅๅฐ๏ผๅฏนๅคงไผๅผๆพ๏ผๅๅๅฐ๏ผไปๅฏน็ฎก็ๅๅผๆพ๏ผใ

ไธ่ฌๅจๅฎ้้กน็ฎไธญ๏ผๅพๅคไบบไผๅงๅๅฐๅๅๅฐๅไธบไธคไธช้กน็ฎๅปๅ๏ผ้จ็ฝฒๆถไนไผๅๅผ้จ็ฝฒ๏ผ

่ฟๆทๅ็ธไบ็ฌ็ซไธๅฎนๆไนฑ๏ผไนๆดๅๅฎๅจใไฝๆฏๆ็น้บป็ฆ๏ผๆไปฅๆไปฌ้็จๆดไธบๅธธ่ง็ๆนๆก๏ผ่ฎฉๅๅฐไฝไธบไธไธชๅญ็ฎๅฝๅบ็ฐใ่ฟๆท็่ฏ๏ผๅคงไฝ็ปๆๅฐฑๆฏ๏ผ

### ๅบๆฌ็็ฎๅฝ็ปๆ
```
โโโ baixiu ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท ้กน็ฎๆไปถๅคน๏ผ็ฝ็ซๆน็ฎๅฝ๏ผ
    โโโ admin ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท ๅๅฐๆไปถๅคน
    โ   โโโ index.php ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท ๅๅฐ่ๆฌๆไปถ
    โโโ static ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท ้ๆๆไปถๅคน
    โ   โโโ assets ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท ่ตๆบๆไปถๅคน
    โ   โโโ uploads ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท ไธไผๆไปถๅคน
    โโโ index.php ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท ๅๅฐ่ๆฌๆไปถ
```


```
โโโ baixiu ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท ้กน็ฎๆไปถๅคน๏ผ็ฝ็ซๆน็ฎๅฝ๏ผ
    โโโ ......
    โโโ static ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท ้ๆๆไปถๅคน
    โ   โโโ assets ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท ่ตๆบๆไปถๅคน
+   โ   โ   โโโ css ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท ๆทๅผๆไปถๅคน
+   โ   โ   โโโ img ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท ๅพ็ๆไปถๅคน
+   โ   โ   โโโ js ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท ่ๆฌๆไปถๅคน
+   โ   โ   โโโ venders ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท ็ฌฌไธๆน่ตๆบ
    โ   โโโ uploads ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท ไธไผๆไปถๅคน
+   โ       โโโ 2017 ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท 2017 ๅนดไธไผๆไปถ็ฎๅฝ
    โโโ ......
```

* `static` ็ฎๅฝไธญๅชๅ่ฎธๅบ็ฐ้ๆๆไปถใ
* `assets` ็ฎๅฝไธญๆพ็ฝฎ็ฝ้กตไธญๆ้็่ตๆบๆไปถใ
* `uploads` ็ฎๅฝไธญๆพ็ฝฎ็ฝ็ซ่ฟ่ฅ่ฟ็จไธญไธไผ็ๆไปถ๏ผๅฆๆๆๅฟๆไปถ่ฟๅค๏ผๅฏไปฅๆๅนดๅฝๆกฃ๏ผไธๅนดไธไธชๆไปถๅคน๏ผใ

### ้กน็ฎ้็ฝฎๆไปถ

็ฑไบๅจๆฅไธๆฅ็ๅผๅ่ฟ็จไธญ๏ผ่ฏๅฎๅไธ้จๅๅฌๅฑ็ๆๅ๏ผไพๅฆๆฐๆฎๅบๅ็งฐ๏ผๆฐๆฎๅบไธปๆบ๏ผๆฐๆฎๅบ็จๆทๅๅฏ็็ญ๏ผ่ฟไบๆฐๆฎๅบ่ฏฅๆพๅฐๅฌๅฑ็ๅฐๆน๏ผๆฝ่ฑกๆไธไธช้็ฝฎๆไปถ config.php ๆพๅฐ้กน็ฎๆน็ฎๅฝไธใ

่ฟไธช้็ฝฎๆไปถ้็จๅฎไนๅธธ้็ๆนๅผๅฎไน้็ฝฎๆๅ๏ผ

```php
/**
 * ๆฐๆฎๅบไธปๆบ
 */
define('DB_HOST', '127.0.0.1');
/**
 * ๆฐๆฎๅบ็จๆทๅ
 */
define('DB_USER', 'root');
/**
 * ๆฐๆฎๅบๅฏ็
 */
define('DB_PASS', 'wanglei');
/**
 * ๆฐๆฎๅบๅ็งฐ
 */
define('DB_NAME', 'baixiu');
```

ๅจ้่ฆ็ๆถๅๅฏไปฅ้่ฟ`require`่ฝฝๅฅ:

```php
// ่ฝฝๅฅ้็ฝฎๆไปถ
require 'config.php';

...

// ็จๅฐ็ๆถๅ
echo DB_NAME;
```

### ่ฝฝๅฅ่ๆฌ็ๅ็งๆนๅผๅฏนๆฏ

* `require`
* `require_once`
* `include`
* `include_once`

* ๅฑๅ็น๏ผ

   * ้ฝๅฏไปฅๅจๅฝๅ PHP ่ๆฌๆไปถๆง่กๆถ่ฝฝๅฅๅฆๅคไธไธช PHP ่ๆฌๆไปถใ
* `require` ๅ `include` ไธๅ็น๏ผ

   * ๅฝ่ฝฝๅฅ็่ๆฌๆไปถไธๅญๅจๆถ๏ผ`require` ไผๆฅไธไธช่ดๅฝ้่ฏฏ๏ผ็ปๆ็จๅบๆง่ก๏ผ๏ผ่ `include` ไธไผ
* ๆ `once` ๅ็ผ็็น็น๏ผ

   * ๅคๆญๅฝๅ่ฝฝๅฅ็่ๆฌๆไปถๆฏๅฆๅทฒ็ป่ฝฝๅฅ่ฟ๏ผๅฆๆ่ฝฝๅฅไบๅฐฑไธๅจๆง่ก
   
### ๆพ็คบPHP้่ฏฏไฟกๆฏ
ๅฝๆง่ก PHP ๆไปถๅ็้่ฏฏๆถ๏ผๅฆๆๅจ้กต้ขไธไธๆพ็คบ้่ฏฏไฟกๆฏ๏ผๅชๆฏๆ็คบ 500 Internal Server Error ้่ฏฏ๏ผๅบ่ฏฅๆฏ PHP ้็ฝฎ็้ฎ้ข๏ผ่งฃๅณๆนๆกๅฐฑๆฏ๏ผๆพๅฐ `php.ini` ้็ฝฎๆไปถไธญ `display_errors` ้้กน๏ผๅฐๅผ่ฎพ็ฝฎไธบ `On`

```php
  ; http://php.net/display-errors
  ; display_errors = Off
  display_errors = On
  ; The display of errors which occur during PHP's startup sequence are handled
```

### ๆฝ็ฆปๅฌๅฑ้จๅ
็ฑไบๆฏไธไธช้กต้ขไธญ้ฝๆไธ้จๅไปฃ็๏ผไพง่พนๆ๏ผๆฏ็ธๅ็๏ผๅๆฃๅฐๅไธชๆไปถไธญ๏ผไธไพฟไบ็ปดๆค๏ผๆไปฅๅบ่ฏฅๆฝ่ฑกๅฐไธไธชๅฌๅฑ็ๆไปถไธญใ

ไบๆฏๆไปฌๅจ `admin` ็ฎๅฝไธญๅๅปบไธไธช `inc`๏ผincludes ็็ฎ็งฐ๏ผๅญ็ฎๅฝ๏ผๅจ่ฟไธช็ฎๅฝ้ๅๅปบไธไธช `sidebar.php` ๆไปถ๏ผ็จไบๆฝ่ฑกๅฌๅฑ็ไพง่พนๆ `<div class="aside"> ... </div>`๏ผ็ถๅๅจๆฏไธไธช้่ฆ่ฟไธชๆจกๅ็้กต้ขไธญ้่ฟ `include` ่ฝฝๅฅ๏ผ

```php
  <?php include 'inc/sidebar.php' ;?>
```

### ไพง่พนๆ็็ฆ็น็ถๆ
็ฑไบไพง่พนๆๅจไธๅ้กต้ขๆถ๏ผactive class name ๅบ็ฐ็ไฝ็ฝฎไธๅฐฝ็ธๅ๏ผๆไปฅๆไปฌ้่ฆๅบๅๅฝๅ `sidebar.php` ๆไปถๆฏๅจๅชไธช้กต้ขไธญ่ฝฝๅฅ็๏ผไป่ๆ็กฎ็ฆ็น็ถๆใ
ๆไปฅ็ฎๅ็ๅณ้ฎ้ฎ้ขๅฐฑๅบ็ฐๅจไบๅฆไฝๅจ `sidebar.php` ไธญ็ฅ้ๅฝๅ่ขซๅชไธชๆไปถ่ฝฝๅฅไบใ

้่ฟๆฅ็ `include` ๅฝๆฐ็ๆๆกฃๅ็ฐ๏ผๅฆๆ `a.php` ้่ฟ `include` ่ฝฝๅฅไบ `b.php` ๆไปถ๏ผ้ฃไนๅจ `b.php` ๆไปถไธญๅฏไปฅ่ฎฟ้ฎๅฐ `a.php` ไธญๅฎไน็ๅ้ใ

> [http://php.net/manual/zh/function.include.php](http://php.net/manual/zh/function.include.php)

ๅๅฉ่ฟไธช็นๆง๏ผๆไปฌๅฏไปฅๅจๅไธช้กต้ขไธญๅฎไนไธไธชๆ่ฏๅ้๏ผ็ถๅๅจ sidebar.php ไธญ้่ฟ่ฟไธชๆ่ฏๅ้ๅบๅซไธๅ้กต้ข็่ฝฝๅฅ๏ผ

ๆฏไธไธช่ๅ้กน `<li>` ๅ็ด๏ผ

```php
<li<?php echo $current_page == 'dashboard' ? ' class="active"' : ''; ?>>
  <a href="index.php"><i class="fa fa-dashboard"></i>ไปช่กจ็</a>
</li>
```

ๅฏนไบๆๅญ่ๅ็่ๅ้กน๏ผๆไธ็นไพๅค๏ผ

```php
<li<?php echo in_array($current_page, array('posts', 'post-add', 'categories')) ? ' class="active"' : ''; ?>>
  <a href="#menu-posts"<?php echo in_array($current_page, array('posts', 'post-add', 'categories')) ? '' : ' class="collapsed"'; ?> data-toggle="collapse">
    <i class="fa fa-thumb-tack"></i>ๆ็ซ<i class="fa fa-angle-right"></i>
  </a>
  <ul id="menu-posts" class="collapse<?php echo in_array($current_page, array('posts', 'post-add', 'categories')) ? ' in' : ''; ?>">
    <li<?php echo $current_page == 'posts' ? ' class="active"' : ''; ?>><a href="posts.php">ๆๆๆ็ซ</a></li>
    <li<?php echo $current_page == 'post-add' ? ' class="active"' : ''; ?>><a href="post-add.php">ๅๆ็ซ</a></li>
    <li<?php echo $current_page == 'categories' ? ' class="active"' : ''; ?>><a href="categories.php">ๅ็ฑป็ฎๅฝ</a></li>
  </ul>
</li>
```
